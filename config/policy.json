{
  "roles": {
    "restricted": {
      "id": 1,
      "name": "restricted",
      "flags": {
        "allow_file_access": false,
        "allow_network": false,
        "allow_exec": false,
        "require_signed_binary": false,
        "allow_setuid": false,
        "allow_ptrace": false
      },
      "file_paths": [],
      "network_rules": [],
      "execution_rules": [],
      "require_signed_binary": false
    },
    "permissive": {
      "id": 2,
      "name": "permissive",
      "flags": {
        "allow_file_access": true,
        "allow_network": true,
        "allow_exec": true,
        "require_signed_binary": false,
        "allow_setuid": false,
        "allow_ptrace": false
      },
      "file_paths": [],
      "network_rules": [],
      "execution_rules": [],
      "require_signed_binary": false
    },
    "webserver": {
      "id": 3,
      "name": "webserver",
      "flags": {
        "allow_file_access": true,
        "allow_network": true,
        "allow_exec": true,
        "require_signed_binary": false,
        "allow_setuid": false,
        "allow_ptrace": false
      },
      "file_paths": [
        {"pattern": "/var/www/**", "allow": true},
        {"pattern": "/var/log/nginx/**", "allow": true}
      ],
      "network_rules": [
        {"protocol": "tcp", "port": 80, "allow": true},
        {"protocol": "tcp", "port": 443, "allow": true},
        {"protocol": "tcp", "port": 8080, "allow": true}
      ],
      "execution_rules": [],
      "require_signed_binary": false
    },
    "database": {
      "id": 4,
      "name": "database",
      "flags": {
        "allow_file_access": true,
        "allow_network": true,
        "allow_exec": false,
        "require_signed_binary": false,
        "allow_setuid": false,
        "allow_ptrace": false
      },
      "file_paths": [
        {"pattern": "/var/lib/postgresql/**", "allow": true},
        {"pattern": "/var/log/postgresql/**", "allow": true}
      ],
      "network_rules": [
        {"protocol": "tcp", "port": 5432, "allow": true},
        {"protocol": "tcp", "port": 6379, "allow": true}
      ],
      "execution_rules": [],
      "require_signed_binary": false
    },
    "isolated": {
      "id": 5,
      "name": "isolated",
      "flags": {
        "allow_file_access": true,
        "allow_network": false,
        "allow_exec": false,
        "require_signed_binary": false,
        "allow_setuid": false,
        "allow_ptrace": false
      },
      "file_paths": [
        {"pattern": "/tmp/**", "allow": true}
      ],
      "network_rules": [],
      "execution_rules": [],
      "require_signed_binary": false
    },
    "web_with_db": {
      "id": 6,
      "name": "web_with_db",
      "flags": {
        "allow_file_access": true,
        "allow_network": true,
        "allow_exec": false,
        "require_signed_binary": false,
        "allow_setuid": false,
        "allow_ptrace": false
      },
      "file_paths": [],
      "network_rules": [
        {"protocol": "tcp", "port": 80, "allow": true},
        {"protocol": "tcp", "port": 443, "allow": true},
        {"protocol": "tcp", "port": 8080, "allow": true},
        {"protocol": "tcp", "port": 5432, "allow": true},
        {"protocol": "tcp", "port": 3306, "allow": true},
        {"protocol": "tcp", "port": 6379, "allow": true}
      ],
      "execution_rules": [],
      "require_signed_binary": false
    },
    "worker": {
      "id": 7,
      "name": "worker",
      "flags": {
        "allow_file_access": true,
        "allow_network": true,
        "allow_exec": true,
        "require_signed_binary": false,
        "allow_setuid": false,
        "allow_ptrace": false
      },
      "file_paths": [],
      "network_rules": [
        {"protocol": "tcp", "port": 443, "allow": true},
        {"protocol": "tcp", "port": 5432, "allow": true},
        {"protocol": "tcp", "port": 6379, "allow": true},
        {"protocol": "tcp", "port": 5672, "allow": true},
        {"protocol": "tcp", "port_start": 8000, "port_end": 8100, "allow": true}
      ],
      "execution_rules": [],
      "require_signed_binary": false
    },
    "webserver_test": {
      "id": 8,
      "name": "webserver_test",
      "flags": {
        "allow_file_access": true,
        "allow_network": false,
        "allow_exec": true,
        "require_signed_binary": false,
        "allow_setuid": false,
        "allow_ptrace": false
      },
      "file_paths": [],
      "network_rules": [
        {"protocol": "tcp", "port": 80, "allow": true},
        {"protocol": "tcp", "port": 443, "allow": true},
        {"protocol": "tcp", "port": 8080, "allow": true}
      ],
      "execution_rules": [],
      "require_signed_binary": false
    },
    "sandbox": {
      "id": 9,
      "name": "sandbox",
      "flags": {
        "allow_file_access": true,
        "allow_network": false,
        "allow_exec": false,
        "require_signed_binary": false,
        "allow_setuid": false,
        "allow_ptrace": false
  },
      "file_paths": [
        {"pattern": "/tmp/", "allow": true},
        {"pattern": "/usr/", "allow": true},
        {"pattern": "/etc/passwd", "allow": false},
        {"pattern": "/etc/shadow", "allow": false}
      ],
      "network_rules": [],
      "execution_rules": [],
      "require_signed_binary": false
    },
    "wildcard_test": {
      "id": 10,
      "name": "wildcard_test",
      "flags": {
        "allow_file_access": true,
        "allow_network": false,
        "allow_exec": false,
        "require_signed_binary": false,
        "allow_setuid": false,
        "allow_ptrace": false
      },
      "file_paths": [
        {"pattern": "/tmp/allowed/", "allow": true},
        {"pattern": "/tmp/blocked/", "allow": false},
        {"pattern": "/tmp/mixed/*/data.txt", "allow": true},
        {"pattern": "/tmp/mixed/secret/", "allow": false},
        {"pattern": "/var/log/", "allow": true},
        {"pattern": "/var/log/secure", "allow": false}
      ],
      "network_rules": [],
      "execution_rules": [],
      "require_signed_binary": false
    },
    "tee_protected": {
      "id": 11,
      "name": "tee_protected",
      "flags": {
        "allow_file_access": true,
        "allow_network": true,
        "allow_exec": true,
        "require_signed_binary": false,
        "allow_setuid": false,
        "allow_ptrace": false,
        "allow_module_load": false,
        "allow_bpf_load": false
      },
      "file_paths": [
        {"pattern": "/proc/", "allow": false},
        {"pattern": "/sys/kernel/", "allow": false}
      ],
      "network_rules": [],
      "execution_rules": [],
      "require_signed_binary": false
    },
    "ai_agent": {
      "id": 12,
      "name": "ai_agent",
      "flags": {
        "allow_file_access": true,
        "allow_network": true,
        "allow_exec": false,
        "require_signed_binary": false,
        "allow_setuid": false,
        "allow_ptrace": false,
        "allow_module_load": false,
        "allow_bpf_load": false,
        "require_proxy": true
      },
      "file_paths": [
        {"pattern": "/proc/", "allow": false},
        {"pattern": "/.ssh/", "allow": false},
        {"pattern": "/.aws/", "allow": false},
        {"pattern": "/.config/gcloud/", "allow": false},
        {"pattern": "/.azure/", "allow": false},
        {"pattern": "/.kube/", "allow": false},
        {"pattern": "/.docker/", "allow": false},
        {"pattern": "/etc/shadow", "allow": false},
        {"pattern": "/etc/gshadow", "allow": false},
        {"pattern": "/etc/ssl/private/", "allow": false},
        {"pattern": "/.npmrc", "allow": false},
        {"pattern": "/.git-credentials", "allow": false},
        {"pattern": "/.netrc", "allow": false},
        {"pattern": "/.gnupg/", "allow": false},
        {"pattern": "/workspace/", "allow": true},
        {"pattern": "/tmp/", "allow": true}
      ],
      "network_rules": [
        {"protocol": "tcp", "port": 443, "allow": true},
        {"protocol": "tcp", "port": 80, "allow": true}
      ],
      "execution_rules": [],
      "require_signed_binary": false,
      "ip_rules": [
        {"cidr": "10.0.0.0/8", "direction": "connect", "allow": false},
        {"cidr": "172.16.0.0/12", "direction": "connect", "allow": false},
        {"cidr": "192.168.0.0/16", "direction": "connect", "allow": false},
        {"cidr": "127.0.0.1/32", "direction": "connect", "allow": true}
      ],
      "domain_rules": [
        {"domain": "api.openai.com", "allow": true},
        {"domain": "api.anthropic.com", "allow": true},
        {"domain": "generativelanguage.googleapis.com", "allow": true}
      ],
      "proxy": {
        "address": "127.0.0.1:8080",
        "required": true
      }
    }
  },
  "pods": [],
  "exec_enrollments": [
    {
      "executable_path": "/usr/bin/nginx",
      "pod_id": 1000,
      "role": "webserver"
    },
    {
      "executable_path": "/usr/bin/redis-server",
      "pod_id": 1001,
      "role": "database"
    }
  ],
  "cgroup_enrollments": [
    {
      "cgroup_path": "/sys/fs/cgroup/bpfjailer/sandbox",
      "pod_id": 2000,
      "role": "sandbox"
    }
  ]
}
